# ------------------------------------------------------------------------------
# Test sync and input ports
# ------------------------------------------------------------------------------

- target: VSYNC
  tests:
    - comment: Load VSYNC 0x1
      cycle: 3
      initial:
        reg: {}
      inputs:
        - clock: 0
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x0, I: 0x0, D_IN: 0x2 }
        - clock: 3
          in: { DEL: 0x0, R_W: 0x0, CS: 0x0, A: 0x0, I: 0x0, D_IN: 0x2 }
      expected:
        reg: {
          VSYNC: 0x1, VBLANK: 0x0, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x1, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x0
        }
- target: VBLANK
  tests:
    - comment: Load VBLANK 0x2
      cycle: 3
      initial:
        reg: {}
      inputs:
        - clock: 0
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x1, I: 0x0, D_IN: 0x2 }
        - clock: 3
          in: { DEL: 0x0, R_W: 0x0, CS: 0x0, A: 0x1, I: 0x0, D_IN: 0x2 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x2, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x1,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x0
        }
- target: WSYNC
  tests:
    - comment: WSYNC at hcount=99 and step 6 color clock
      cycle: 105
      initial:
        reg: {}
      inputs:
        - clock: 99
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x02, I: 0x00, D_IN: 0x00 }
        - clock: 102
          in: { DEL: 0x0, R_W: 0x0, CS: 0x0, A: 0x02, I: 0x00, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x00, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x0, HSYNC: 0x0, HBLANK: 0x0, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x00
        }
- target: WSYNC
  tests:
    - comment: WSYNC at hcount=99 and step 129 color clock
      cycle: 228
      initial:
        reg: {}
      inputs:
        - clock: 99
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x02, I: 0x00, D_IN: 0x00 }
        - clock: 102
          in: { DEL: 0x0, R_W: 0x0, CS: 0x0, A: 0x02, I: 0x00, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x00, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x00
        }
- target: RSYNC
  tests:
    - comment: Reset hcount to 0
      cycle: 100
      initial:
        reg: {}
      inputs:
        - clock: 99
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x03, I: 0x00, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x00, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x00
        }
- target: INPT0
  tests:
    - comment: Input port 0
      cycle: 3
      initial:
        reg: {}
      inputs:
        - clock: 0
          in: { DEL: 0x0, R_W: 0x1, CS: 0x1, A: 0x08, I: 0x01, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x0, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x80
        }
- target: INPT0
  tests:
    - comment: Input port 0 with VSYNC[7] (dumped)
      cycle: 6
      initial:
        reg: {}
      inputs:
        - clock: 0
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x01, I: 0x01, D_IN: 0x80 }
        - clock: 3
          in: { DEL: 0x0, R_W: 0x1, CS: 0x1, A: 0x08, I: 0x01, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x80, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x00
        }
- target: INPT4
  tests:
    - comment: Input port 4
      cycle: 3
      initial:
        reg: {}
      inputs:
        - clock: 0
          in: { DEL: 0x0, R_W: 0x1, CS: 0x1, A: 0x0c, I: 0x10, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x0, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x80
        }
- target: INPT4
  tests:
    - comment: Input port 4 with VBLANK[6] (latched)
      cycle: 6
      initial:
        reg: {}
      inputs:
        - clock: 0
          in: { DEL: 0x0, R_W: 0x0, CS: 0x1, A: 0x01, I: 0x10, D_IN: 0x40 }
        - clock: 3
          in: { DEL: 0x0, R_W: 0x1, CS: 0x1, A: 0x0c, I: 0x00, D_IN: 0x00 }
      expected:
        reg: {
          VSYNC: 0x0, VBLANK: 0x40, NUSIZ0: 0x0, NUSIZ1: 0x0,
          COLUP0: 0x0, COLUP1: 0x0, COLUPF: 0x0, COLUBK: 0x0, CTRLPF: 0x0,
          REFP0: 0x0, REFP1: 0x0, PF0: 0x0, PF1: 0x0, PF2: 0x0,
          GRP0: 0x0, GRP1: 0x0, GRP0D: 0x0, GRP1D: 0x0,
          ENAM0: 0x0, ENAM1: 0x0, ENABL: 0x0, ENABLD: 0x0,
          HMP0: 0x0, HMP1: 0x0, HMM0: 0x0, HMM1: 0x0, HMBL: 0x0,
          POSP0: 0x0, POSP1: 0x0, POSM0: 0x0, POSM1: 0x0, POSBL: 0x0,
          VDELP0: 0x0, VDELP1: 0x0, VDELBL: 0x0,
          RESMP0: 0x0, RESMP1: 0x0, CXCLR: 0x0, CXR: 0x0
        }
        out: {
          RDY: 0x1, HSYNC: 0x0, HBLANK: 0x1, VSYNC: 0x0, VBLANK: 0x0,
          LUM: 0x0, COL: 0x0, AUD: 0x0, D_OUT: 0x80
        }
